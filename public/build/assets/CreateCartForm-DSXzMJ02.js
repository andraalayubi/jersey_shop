import{r as m,W as z,j as e,B as y,c as b,n as p}from"./app-BHSufI5G.js";import{L as N}from"./LoadingOverlay-DY-17BFl.js";import{S as q}from"./Select-ByrTyIfn.js";import{N as B}from"./NumberInput-yxXV7j6Y.js";import"./use-resolved-styles-api-C-ix6nIl.js";import"./Popover-C9BlbU81.js";import"./DirectionProvider-6MtzQ78E.js";import"./Input-Bj5l2KtT.js";import"./CheckIcon-DSLILbTp.js";import"./ScrollArea-24-TSSmI.js";import"./InputBase-J5VieEbK.js";import"./clamp-DTmYCdls.js";const G=({product:s,selectSizeData:a,user:h,totalStock:l})=>{const[c,g]=m.useState(""),{data:r,setData:d,post:f,processing:u,errors:o,reset:n}=z({product_size_id:"",quantity:0}),j=t=>{t.preventDefault(),f(`/products/${s.id}/carts`,{preserveScroll:!0,onSuccess:h.is_admin?null:()=>{n("product_size_id"),n("quantity"),p.show({color:"green",title:"Success notification",message:"Berhasil menambahkan ke keranjang!"})},onError:()=>{n("product_size_id"),n("quantity"),p.show({color:"red",title:"Error notification",message:"Gagal menambahkan ke keranjang!"})}})},[k,_]=m.useState(0),S=t=>{const i=s.product_size.find(v=>v.id===t);_(i.stock)};return e.jsx(e.Fragment,{children:s.product_size.length||l>0?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-sm mb-4",children:["Total stok produk: ",l]}),e.jsxs(y,{pos:"relative",children:[e.jsx(N,{visible:u,zIndex:1e3,overlayProps:{radius:"sm",blur:2}}),e.jsxs("form",{onSubmit:j,children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(q,{size:"md",placeholder:"Pilih ukuran",data:a,value:c?c.value:"",onChange:(t,i)=>{g(i),d("product_size_id",i.value),S(i.value)},error:o.product_size_id?o.product_size_id:!1}),e.jsx(B,{size:"md",placeholder:"Jumlah",allowNegative:!1,allowDecimal:!1,thousandSeparator:".",decimalSeparator:",",value:r.quantity,clampBehavior:"strict",min:0,max:k,onChange:t=>d("quantity",parseInt(t)),error:o.quantity?o.quantity:!1})]}),s.product_size.map(t=>t.id===r.product_size_id&&e.jsxs("p",{className:`mt-4 text-sm ${x(t.stock,r.quantity)<=5?"text-red-500":""}`,children:["Sisa stok ukuran ini:"," ",e.jsx("span",{children:x(t.stock,r.quantity)})]},t.id)),e.jsxs("p",{className:"text-xl mt-4 text-primary",children:["Total: Rp",(s.price*r.quantity).toLocaleString()]}),e.jsx("div",{className:"mt-6",children:e.jsx(b,{type:"submit",size:"md",fullWidth:!0,disabled:u,children:"Masukkan Keranjang"})})]})]})]}):e.jsx("p",{className:"text-sm italic",children:"Stok produk kosong"})})},x=(s,a)=>a?a>s?0:s-a:s;export{G as default};
